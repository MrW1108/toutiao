{"version":3,"sources":["webpack:///./node_modules/core-js/modules/es.regexp.to-string.js","webpack:///./src/utils/global-bus.js","webpack:///./src/views/user-profile/index.vue?1f3c","webpack:///src/views/user-profile/index.vue","webpack:///./src/views/user-profile/index.vue?320d","webpack:///./src/views/user-profile/index.vue","webpack:///./src/views/user-profile/index.vue?72e9","webpack:///./src/api/user.js"],"names":["uncurryThis","PROPER_FUNCTION_NAME","PROPER","redefine","anObject","isPrototypeOf","$toString","fails","regExpFlags","TO_STRING","RegExpPrototype","RegExp","prototype","n$ToString","getFlags","NOT_GENERIC","call","source","flags","INCORRECT_NAME","name","R","this","p","rf","f","undefined","unsafe","Vue","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","on","$event","$router","replace","onShowFile","user","photo","ref","onFileChange","onEditNameShow","gender","isEditGenerShow","birthday","isEditBirthdayShow","staticStyle","$refs","focus","model","value","callback","$$v","isEditNameShow","expression","onNameConfirm","inputName","columns","onPickerChange","saveProfile","selectedGender","minDate","onBirthdayConfirm","currentDate","isPreviewPhotoShow","previewImage","_e","_v","onPhotoConfirm","staticRenderFns","components","ImgCropper","data","isNameShow","actions","Date","previewImages","computed","file","created","loadUserProfile","methods","index","click","push","fileObj","component","login","request","method","url","getUserInfo","getUserChannels","followUser","userId","target","unFollowUser","getProfile","updateUserPhoto","formData","updateUserProfile","getUserById","getFollowingsByUser","params","toString","getFollowersByUser"],"mappings":"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","file":"js/chunk-deccc806.873c33ff.js","sourcesContent":["'use strict';\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar PROPER_FUNCTION_NAME = require('../internals/function-name').PROPER;\nvar redefine = require('../internals/redefine');\nvar anObject = require('../internals/an-object');\nvar isPrototypeOf = require('../internals/object-is-prototype-of');\nvar $toString = require('../internals/to-string');\nvar fails = require('../internals/fails');\nvar regExpFlags = require('../internals/regexp-flags');\n\nvar TO_STRING = 'toString';\nvar RegExpPrototype = RegExp.prototype;\nvar n$ToString = RegExpPrototype[TO_STRING];\nvar getFlags = uncurryThis(regExpFlags);\n\nvar NOT_GENERIC = fails(function () { return n$ToString.call({ source: 'a', flags: 'b' }) != '/a/b'; });\n// FF44- RegExp#toString has a wrong name\nvar INCORRECT_NAME = PROPER_FUNCTION_NAME && n$ToString.name != TO_STRING;\n\n// `RegExp.prototype.toString` method\n// https://tc39.es/ecma262/#sec-regexp.prototype.tostring\nif (NOT_GENERIC || INCORRECT_NAME) {\n  redefine(RegExp.prototype, TO_STRING, function toString() {\n    var R = anObject(this);\n    var p = $toString(R.source);\n    var rf = R.flags;\n    var f = $toString(rf === undefined && isPrototypeOf(RegExpPrototype, R) && !('flags' in RegExpPrototype) ? getFlags(R) : rf);\n    return '/' + p + '/' + f;\n  }, { unsafe: true });\n}\n","import Vue from 'vue'\n\nexport default new Vue()\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('van-nav-bar',{staticClass:\"page-navbar\",attrs:{\"title\":\"个人信息\",\"left-arrow\":\"\"},on:{\"click-left\":function($event){return _vm.$router.replace('/my')}}}),_c('van-cell-group',[_c('van-cell',{attrs:{\"title\":\"头像\",\"is-link\":\"\",\"center\":\"\"},on:{\"click\":_vm.onShowFile}},[_c('van-image',{staticClass:\"avatar\",attrs:{\"round\":\"\",\"fit\":\"cover\",\"src\":_vm.user.photo}})],1),_c('input',{ref:\"file\",attrs:{\"type\":\"file\",\"hidden\":\"\",\"accept\":\"image/*\"},on:{\"change\":_vm.onFileChange}}),_c('van-cell',{attrs:{\"title\":\"昵称\",\"value\":_vm.user.name,\"is-link\":\"\"},on:{\"click\":_vm.onEditNameShow}}),_c('van-cell',{attrs:{\"title\":\"性别\",\"value\":_vm.user.gender === 0 ? '男' : '女',\"is-link\":\"\"},on:{\"click\":function($event){_vm.isEditGenerShow = true}}}),_c('van-cell',{attrs:{\"title\":\"生日\",\"value\":_vm.user.birthday,\"is-link\":\"\"},on:{\"click\":function($event){_vm.isEditBirthdayShow = true}}})],1),_c('van-popup',{staticClass:\"intro-popup\",staticStyle:{\"height\":\"100%\"},attrs:{\"position\":\"bottom\",\"get-container\":\"body\"},on:{\"opened\":function($event){return _vm.$refs.name.focus()}},model:{value:(_vm.isEditNameShow),callback:function ($$v) {_vm.isEditNameShow=$$v},expression:\"isEditNameShow\"}},[_c('van-nav-bar',{attrs:{\"title\":\"昵称\",\"left-text\":\"取消\",\"right-text\":\"完成\"},on:{\"click-left\":function($event){_vm.isEditNameShow = false},\"click-right\":_vm.onNameConfirm}}),_c('div',{staticClass:\"intro-field-wrap\"},[_c('van-field',{ref:\"name\",attrs:{\"rows\":\"2\",\"autosize\":\"\",\"type\":\"textarea\",\"maxlength\":\"7\",\"placeholder\":\"请输入昵称\",\"show-word-limit\":\"\",\"id\":\"name\"},model:{value:(_vm.inputName),callback:function ($$v) {_vm.inputName=$$v},expression:\"inputName\"}})],1)],1),_c('van-popup',{attrs:{\"position\":\"bottom\",\"get-container\":\"body\"},model:{value:(_vm.isEditGenerShow),callback:function ($$v) {_vm.isEditGenerShow=$$v},expression:\"isEditGenerShow\"}},[_c('van-picker',{attrs:{\"show-toolbar\":\"\",\"title\":\"性别\",\"columns\":_vm.columns,\"default-index\":_vm.user.gender},on:{\"cancel\":function($event){_vm.isEditGenerShow = false},\"change\":_vm.onPickerChange,\"confirm\":function($event){return _vm.saveProfile('gender', _vm.selectedGender)}}})],1),_c('van-popup',{attrs:{\"position\":\"bottom\"},model:{value:(_vm.isEditBirthdayShow),callback:function ($$v) {_vm.isEditBirthdayShow=$$v},expression:\"isEditBirthdayShow\"}},[_c('van-datetime-picker',{attrs:{\"type\":\"date\",\"min-date\":_vm.minDate,\"confirm-button-text\":\"完成\"},on:{\"confirm\":_vm.onBirthdayConfirm,\"cancel\":function($event){_vm.isEditBirthdayShow = false}},model:{value:(_vm.currentDate),callback:function ($$v) {_vm.currentDate=$$v},expression:\"currentDate\"}})],1),_c('van-popup',{staticStyle:{\"height\":\"100%\",\"background-color\":\"#000\"},attrs:{\"position\":\"bottom\"},model:{value:(_vm.isPreviewPhotoShow),callback:function ($$v) {_vm.isPreviewPhotoShow=$$v},expression:\"isPreviewPhotoShow\"}},[(_vm.isPreviewPhotoShow)?_c('img-cropper',{ref:\"img-cropper\",attrs:{\"src\":_vm.previewImage}}):_vm._e(),_c('div',{staticClass:\"crop-bottom\"},[_c('span',{on:{\"click\":function($event){_vm.isPreviewPhotoShow = false}}},[_vm._v(\"取消\")]),_c('span',{on:{\"click\":_vm.onPhotoConfirm}},[_vm._v(\"完成\")])])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <van-nav-bar\n      class=\"page-navbar\"\n      title=\"个人信息\"\n      left-arrow\n      @click-left=\"$router.replace('/my')\"\n    />\n    <van-cell-group>\n      <van-cell title=\"头像\" is-link @click=\"onShowFile\" center>\n        <van-image\n          class=\"avatar\"\n          round\n          fit=\"cover\"\n          :src=\"user.photo\"\n        />\n      </van-cell>\n      <input\n        type=\"file\"\n        hidden\n        ref=\"file\"\n        accept=\"image/*\"\n        @change=\"onFileChange\"\n      >\n      <van-cell\n        title=\"昵称\"\n        :value=\"user.name\"\n        is-link\n        @click=\"onEditNameShow\"\n      />\n      <van-cell\n        title=\"性别\"\n        :value=\"user.gender === 0 ? '男' : '女'\"\n        is-link\n        @click=\"isEditGenerShow = true\"\n      />\n      <van-cell\n        title=\"生日\"\n        :value=\"user.birthday\"\n        is-link\n        @click=\"isEditBirthdayShow = true\"\n      />\n    </van-cell-group>\n\n    <!-- 修改昵称 -->\n    <van-popup\n      style=\"height: 100%;\"\n      class=\"intro-popup\"\n      v-model=\"isEditNameShow\"\n      position=\"bottom\"\n      get-container=\"body\"\n      @opened=\"$refs.name.focus()\"\n    >\n      <van-nav-bar\n        title=\"昵称\"\n        left-text=\"取消\"\n        right-text=\"完成\"\n        @click-left=\"isEditNameShow = false\"\n        @click-right=\"onNameConfirm\"\n      >\n      </van-nav-bar>\n      <div class=\"intro-field-wrap\">\n        <van-field\n          v-model=\"inputName\"\n          rows=\"2\"\n          autosize\n          type=\"textarea\"\n          maxlength=\"7\"\n          placeholder=\"请输入昵称\"\n          show-word-limit\n          ref=\"name\"\n          id=\"name\"\n        />\n      </div>\n    </van-popup>\n    <!-- /修改昵称 -->\n\n    <!-- 修改性别 -->\n    <van-popup\n      v-model=\"isEditGenerShow\"\n      position=\"bottom\"\n      get-container=\"body\"\n    >\n      <van-picker\n        show-toolbar\n        title=\"性别\"\n        :columns=\"columns\"\n        @cancel=\"isEditGenerShow = false\"\n        :default-index=\"user.gender\"\n        @change=\"onPickerChange\"\n        @confirm=\"saveProfile('gender', selectedGender)\"\n      />\n    </van-popup>\n    <!-- <van-action-sheet\n      v-model=\"isEditGenerShow\"\n      :actions=\"actions\"\n      @select=\"onGenerSelect\"\n      cancel-text=\"取消\"\n    /> -->\n    <!-- /修改性别 -->\n\n    <!-- 修改生日 -->\n    <van-popup\n      v-model=\"isEditBirthdayShow\"\n      position=\"bottom\"\n    >\n      <van-datetime-picker\n        v-model=\"currentDate\"\n        type=\"date\"\n        :min-date=\"minDate\"\n        confirm-button-text=\"完成\"\n        @confirm=\"onBirthdayConfirm\"\n        @cancel=\"isEditBirthdayShow = false\"\n      />\n    </van-popup>\n    <!-- /修改生日 -->\n\n    <!-- 上传头像预览裁切 -->\n    <van-popup\n      v-model=\"isPreviewPhotoShow\"\n      style=\"height: 100%; background-color: #000\"\n      position=\"bottom\"\n    >\n      <img-cropper\n        v-if=\"isPreviewPhotoShow\"\n        :src=\"previewImage\"\n        ref=\"img-cropper\"\n      />\n      <div class=\"crop-bottom\">\n        <span @click=\"isPreviewPhotoShow = false\">取消</span>\n        <span @click=\"onPhotoConfirm\">完成</span>\n      </div>\n    </van-popup>\n    <!-- /上传头像预览裁切 -->\n\n    <!-- 上传头像预览 -->\n    <!-- <van-image-preview\n      v-model=\"isPreviewPhotoShow\"\n      :images=\"previewImages\"\n    >\n      <van-nav-bar\n        slot=\"cover\"\n        left-text=\"取消\"\n        right-text=\"确定\"\n        @click-right=\"onUpdatePhoto\"\n      />\n    </van-image-preview> -->\n    <!-- /上传头像预览 -->\n  </div>\n</template>\n\n<script>\nimport {\n  getProfile,\n  updateUserProfile,\n  updateUserPhoto\n} from '@/api/user'\nimport dayjs from 'dayjs'\nimport globalBus from '@/utils/global-bus'\nimport ImgCropper from '@/components/img-cropper'\n\nexport default {\n  name: 'UserProfile',\n  components: {\n    ImgCropper\n  },\n  data () {\n    return {\n      user: {\n      },\n      isEditNameShow: false,\n      isNameShow: false,\n      inputName: '',\n      isEditGenerShow: false,\n      actions: [\n        { name: '男', value: 0 },\n        { name: '女', value: 1 }\n      ],\n      isEditBirthdayShow: false,\n      currentDate: new Date(),\n      minDate: new Date(1970, 1, 1),\n      isPreviewPhotoShow: false,\n      previewImages: [],\n      previewImage: '',\n      columns: ['男', '女'],\n      selectedGender: 0\n    }\n  },\n  computed: {\n    file () {\n      return this.$refs.file\n    }\n  },\n  created () {\n    this.loadUserProfile()\n  },\n  methods: {\n    onPickerChange (picker, value, index) {\n      this.selectedGender = index\n    },\n    async loadUserProfile () {\n      const { data } = await getProfile()\n      this.user = data.data\n      this.currentDate = new Date(this.user.birthday)\n    },\n\n    onEditNameShow () {\n      this.inputName = this.user.name\n      this.isEditNameShow = true\n    },\n\n    onShowFile () {\n      this.file.click()\n    },\n\n    onFileChange () {\n      const fileObj = URL.createObjectURL(this.file.files[0])\n      // 清空数组\n      this.previewImages = []\n      // 添加预览图片\n      this.previewImages.push(fileObj)\n      this.previewImage = fileObj\n      // 显示预览\n      this.isPreviewPhotoShow = true\n\n      this.file.value = ''\n    },\n\n    async saveProfile (field, value) {\n      this.$toast.loading({\n        duration: 0, // 持续时间，0表示持续展示不停止\n        forbidClick: true, // 是否禁止背景点击\n        message: '保存中...' // 提示消息\n      })\n\n      try {\n        await updateUserProfile({\n          [field]: value\n        })\n        this.$toast.success('保存成功')\n        this.user[field] = value\n        globalBus.$emit('user-update')\n        this.isEditGenerShow = false\n      } catch (err) {\n        this.$toast.success('保存失败')\n        return Promise.reject(err)\n      }\n    },\n\n    async onNameConfirm () {\n      try {\n        // 请求更新\n        await this.saveProfile('name', this.inputName)\n\n        // 更新视图\n        this.user.name = this.inputName\n\n        // 关闭弹层\n        this.isEditNameShow = false\n      } catch ({ response }) {\n        if (response.status === 400) {\n          this.$toast.fail('昵称必须在1-7个字符之间')\n        } else if (response.status === 409) {\n          this.$toast.fail('昵称已存在')\n        }\n      }\n    },\n\n    async onGenerSelect (item) {\n      // 请求更新\n      await this.saveProfile('gender', item.value)\n\n      // 更新视图\n      this.user.gender = item.value\n\n      // 关闭弹层\n      this.isEditGenerShow = false\n    },\n\n    async onBirthdayConfirm (value) {\n      const birthday = dayjs(value).format('YYYY-MM-DD')\n\n      // 请求更新\n      await this.saveProfile('birthday', birthday)\n\n      // 更新视图\n      this.user.birthday = birthday\n\n      // 关闭弹层\n      this.isEditBirthdayShow = false\n    },\n\n    async onUpdatePhoto () {\n      this.$toast.loading({\n        duration: 0, // 持续时间，0表示持续展示不停止\n        forbidClick: true, // 是否禁止背景点击\n        message: '保存中...' // 提示消息\n      })\n\n      try {\n        // 构造包含文件的表单数据对象\n        const fd = new FormData()\n        const fileObj = this.file.files[0]\n        fd.append('photo', fileObj)\n\n        // 请求更新\n        await updateUserPhoto(fd)\n\n        // 更新视图\n        this.user.photo = URL.createObjectURL(fileObj)\n\n        // 关闭图片预览\n        this.isPreviewPhotoShow = false\n\n        this.$toast.success('保存成功')\n\n        globalBus.$emit('user-update')\n      } catch (err) {\n        this.$toast.success('保存失败')\n      }\n    },\n\n    async onPhotoConfirm () {\n      this.$toast.loading({\n        duration: 0, // 持续时间，0表示持续展示不停止\n        forbidClick: true, // 是否禁止背景点击\n        message: '保存中...' // 提示消息\n      })\n\n      try {\n        // 构造包含文件的表单数据对象\n        const fd = new FormData()\n        const blob = await this.$refs['img-cropper'].getCroppedBlob()\n        console.log(blob)\n        // const fileObj = this.file.files[0]\n        fd.append('photo', blob)\n\n        // 请求更新\n        await updateUserPhoto(fd)\n\n        // 更新视图\n        this.user.photo = URL.createObjectURL(blob)\n\n        // 关闭图片预览\n        this.isPreviewPhotoShow = false\n\n        this.$toast.success('保存成功')\n\n        globalBus.$emit('user-update')\n      } catch (err) {\n        this.$toast.success('保存失败')\n      }\n    }\n  }\n}\n</script>\n\n<style scoped lang=\"less\">\n.intro-popup {\n  background-color: #f5f7f9;\n  .intro-field-wrap {\n    padding: 10px;\n  }\n}\n\n.avatar {\n  width: 30px;\n  height: 30px;\n}\n\n/deep/ .van-image-preview__cover {\n  left: 0;\n  bottom: 0;\n  right: 0;\n  top: unset;\n  .van-nav-bar {\n    background: #000;\n  }\n}\n\n.crop-bottom {\n  position: fixed;\n  bottom: 0;\n  height: 44px;\n  font-size: 16px;\n  color: #fff;\n  /* background: #000; */\n  /* background-color: rgba(0, 0, 0, .6); */\n  left: 0;\n  right: 0;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 16px;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=7491f446&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=7491f446&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7491f446\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=7491f446&scoped=true&lang=less&\"","/**\n * 用户相关的请求模块\n */\nimport request from '@/utils/request'\n\n/**\n * 用户登录\n */\n// export function login (data) {\n//   return request({\n//     method: 'POST',\n//     url: '/user/login',\n//     data\n//   })\n// }\nexport function login(data) {\n    return request({\n        method: 'POST',\n        url: '/example/user/login',\n        data\n    })\n}\n/**\n *\n * 获取用户个人信息（头像\n */\nexport function getUserInfo() {\n    return request({\n        method: 'GET',\n        url: '/example/user/UserInfo'\n    })\n}\n/**\n * 获取用户频道列表\n * 如果登录了：获取用户频道列表\n * 没有登录：获取默认推荐的频道列表\n */\nexport function getUserChannels () {\n  return request({\n    method: 'GET',\n    url: '/example/channel/channels'\n  })\n}\n\n/**\n * 关注用户\n */\nexport function followUser (userId) {\n  return request({\n    method: 'POST',\n    url: '/app/v1_0/user/followings',\n    data: {\n      target: userId\n    }\n  })\n}\n\n/**\n * 取消关注用户\n */\nexport function unFollowUser (userId) {\n  return request({\n    method: 'DELETE',\n    url: `/app/v1_0/user/followings/${userId}`\n  })\n}\n\n\n\n/**\n * 获取用户个人资料\n */\nexport function getProfile (userId) {\n  return request({\n    method: 'GET',\n    url: '/app/v1_0/user/profile'\n  })\n}\n\n/**\n * 更新用户照片资料\n */\nexport function updateUserPhoto (formData) {\n  return request({\n    method: 'PATCH',\n    url: '/app/v1_0/user/photo',\n    // Content-Type multipart/form-data\n    // 必须传递 FormData 对象\n    data: formData\n  })\n}\n\n/**\n * 更新用户照片资料\n */\nexport function updateUserProfile (data) {\n  return request({\n    method: 'PATCH',\n    url: '/app/v1_0/user/profile',\n    data\n  })\n}\n\n/**\n * 获取验证码\n */\nexport function sendSmsCode (mobile) {\n  return request({\n    method: 'GET',\n    url: `/app/v1_0/sms/codes/${mobile}`\n  })\n}\n\n/**\n * 获取指定用户信息\n */\nexport function getUserById (userId) {\n  return request({\n    method: 'GET',\n    url: `/app/v1_0/users/${userId}`\n  })\n}\n\n/**\n * 获取用户的关注列表\n */\nexport function getFollowingsByUser (userId, params) {\n  return request({\n    method: 'GET',\n    url: '/app/v1_0/user/followings',\n    params,\n    data: {\n      target: userId.toString()\n    }\n  })\n}\n\n/**\n * 获取用户的粉丝列表\n */\nexport function getFollowersByUser (userId, params) {\n  return request({\n    method: 'GET',\n    url: '/app/v1_0/user/followers',\n    params,\n    data: {\n      target: userId.toString()\n    }\n  })\n}\n"],"sourceRoot":""}